% ==================================================================
% FILE     lucidaBrightOT.sty
% MACHINE  all
% INFO     Lucida Bright package for Lua(La)TeX
%          Font: Lucida Bright (TUG)
%
% DATE     25.02.2017
% OWNER    Bischofberger
% ==================================================================

\ProvidesPackage{lucidaBrightOT}

% kerning tables:
% Note: math fonts have quite different kerning,
%       therefore we must have to seperate tables
\directlua {
  fonts.handlers.otf.addfeature {
    name = "lucidakern",
    {
      type = "kern",
      data = {
        ["A"] = { ["a"] = -10,
                  ["c"] = -15,
                  ["d"] = -10,
                  ["e"] = -15,
                  ["o"] = -15,
                  ["p"] = -10,
                  ["q"] = -15,
                  ["t"] = -10,
                  ["u"] = -10,
                  ["v"] = -20,
                  ["w"] = -20,
                  ["y"] = -20,
                  ["z"] = -10 },
        ["C"] = { ["e"] = -10,
                  ["o"] = -10,
                  ["w"] = -10,
                  ["y"] = -10 }, 
        ["D"] = { ["a"] = -05,
                  ["e"] = -05,
                  ["o"] = -04 },
        ["F"] = { ["a"] = -15,
                  ["e"] = -15,
                  ["y"] = -10 },
        ["H"] = { ["a"] = -05,
                  ["e"] = -05 },
        ["I"] = { ["b"] =  10,
                  ["o"] = -05,
                  ["q"] = -05 },
        ["J"] = { ["a"] = -10,
                  ["e"] = -05,
                  ["o"] = -05 },
        ["K"] = { ["a"] = -10,
                  ["e"] = -10,
                  ["o"] = -10,
                  ["u"] = -05,
                  ["y"] = -10 },
        ["L"] = { ["y"] = -10 },
        ["N"] = { ["a"] = -05,
                  ["i"] = -05,
                  ["o"] = -05 },
        ["O"] = { ["a"] = -05,
                  ["g"] = -05,
                  ["h"] = -05,
                  ["k"] = -05,
                  ["l"] = -05,
                  ["t"] = -05 },
        ["P"] = { ["a"] = -05,
                  ["o"] = -05,
                  ["v"] =  10,
                  ["w"] =  10 },
        ["R"] = { ["a"] = -05,
                  ["d"] = -05,
                  ["e"] = -00,
                  ["j"] = -10,
                  ["o"] = -10,
                  ["u"] = -05,
                  ["w"] = -15,
                  ["y"] = -15 },
        ["T"] = { ["a"] = -30,
                  ["d"] = -30,
                  ["e"] = -30,
                  ["o"] = -30,
                  ["r"] = -20,
                  ["s"] = -20,
                  ["u"] = -15,
                  ["w"] = -20,
                  ["y"] = -20,
                  ["z"] = -15 },
        ["V"] = { ["a"] = -25,
                  ["e"] = -25,
                  ["o"] = -25,
                  ["s"] = -10 },
        ["W"] = { ["a"] = -20,
                  ["e"] = -25,
                  ["o"] = -20,
                  ["y"] = -15 },
        ["Y"] = { ["a"] = -30,
                  ["e"] = -30,
                  ["i"] = -10,
                  ["o"] = -30,
                  ["p"] = -30,
                  ["s"] = -30,
                  ["u"] = -20 },
        ["Z"] = { ["a"] = -20,
                  ["e"] = -20,
                  ["o"] = -20,
                  ["u"] = -20,
                  ["Ã¼"] = -20,
                  ["y"] = -10 },
        ["1"] = { ["0"] = -20,
                  ["1"] = -30,
                  ["2"] = -20,
                  ["3"] = -20,
                  ["4"] = -20,
                  ["5"] = -20,
                  ["6"] = -20,
                  ["7"] = -20,
                  ["8"] = -20,
                  ["9"] = -20 },
        ["2"] = { ["1"] = -20, ["7"] = -20 },
        ["3"] = { ["1"] = -20, ["7"] = -20 },
        ["4"] = { ["1"] = -20, ["7"] = -20 },
        ["5"] = { ["1"] = -20, ["7"] = -20 },
        ["6"] = { ["1"] = -20, ["7"] = -20 },
        ["7"] = { ["1"] = -20, ["1"] = -20 },
        ["8"] = { ["1"] = -20, ["7"] = -20 },
        ["9"] = { ["1"] = -20, ["7"] = -20 },
        ["O"] = { ["1"] = -35, ["7"] = -20 }
      }
    }
  }

  fonts.handlers.otf.addfeature {
    name = "lucidamathkern",
    {
      type = "kern",
      data = {
        ["1"] = { ["0"] = -80,
                  ["1"] = -80,
                  ["2"] = -40,
                  ["3"] = -40,
                  ["4"] = -40,
                  ["5"] = -40,
                  ["6"] = -40,
                  ["7"] = -80,
                  ["8"] = -40,
                  ["9"] = -40 },
        ["2"] = { ["1"] = -40, ["7"] = -40 },
        ["3"] = { ["1"] = -40, ["7"] = -40 },
        ["4"] = { ["1"] = -40, ["7"] = -40 },
        ["5"] = { ["1"] = -40, ["7"] = -40 },
        ["6"] = { ["1"] = -40, ["7"] = -40 },
        ["7"] = { ["1"] = -40, ["1"] = -40 },
        ["8"] = { ["1"] = -40, ["7"] = -40 },
        ["9"] = { ["1"] = -40, ["7"] = -40 },
        ["O"] = { ["1"] = -60, ["7"] = -40 }
      }
    }
  }

}  % end directlua

% set the fonts (fontspec)
\setmainfont{LucidaBrightOT.otf}[%
  ItalicFont=LucidaBrightOT-Italic.otf,
  BoldFont=LucidaBrightOT-Demi.otf,
  BoldItalicFont=LucidaBrightOT-DemiItalic.otf,
  RawFeature={+lucidakern},
  Ligatures=TeX]
\setsansfont{LucidaSansOT.otf}[%
  ItalicFont=LucidaSansOT-Italic.otf,
  BoldFont=LucidaSansOT-Demi.otf,
  BoldItalicFont=LucidaSansOT-DemiItalic.otf,
  %RawFeature={+lucidakern,+lucidamathkern},
  Ligatures=TeX]
\setmonofont{LucidaSansTypewriterOT.otf}[%
  ItalicFont=LucidaSansTypewriterOT-Oblique.otf,
  BoldFont=LucidaSansTypewriterOT-Bold.otf,
  BoldItalicFont=LucidaSansTypewriterOT-BoldOblique.otf]

% set the math fonts (unicode-math)
% no kerning support yet...
\setmathfont{LucidaBrightMathOT.otf}[RawFeature={+lucidamathkern}]
\setmathfont{LucidaBrightMathOT-Demi.otf}[version=bold,RawFeature={+lucidamathkern}]

% lucida needs a bit extra line stretch
\renewcommand{\baselinestretch}{1.2} 
